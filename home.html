<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PawPal!</title>
  <link rel="stylesheet" href="https://unpkg.com/98.css">
  <link rel="stylesheet" href="./style.css">
  <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js"></script>
</head>

<BODY bgcolor="#BFBDC0">
  <div style="display: flex; flex-direction: column; margin: 0px 36px; padding-bottom: 5px;">
    <div style="display: flex; align-items: center;">
      <h4 style="margin-top: 0px;">PawPal</h4>
      <p style="text-align: center; margin-left: auto;">
        &copy; 1998 PawPal!
      </p>
    </div>
    
    <div>
      <button id="logout-button" style="margin-left: auto;">Logout</button>
      <label id="channel" style="margin-left: auto;">Channel: </label>
      <select id="channel-select" style="margin-left: auto;">
        <optgroup label="General">
        <option value="home">Home</option>
        <option value="livechat">Livechat</option>
        </optgroup>
        <optgroup label="Groupchats">
        </optgroup>
        <optgroup label="DMS">
        </optgroup>
      </select>

      <script type="module">
        import { getUserData } from './userdata.js';
      
        const userData = getUserData();
        console.log(userData);
      
        if (userData) {
          for (const chat of userData.chats) {
            const option = document.createElement('option');
            if (chat.type === 0) {
              option.value = chat.nickname;
              option.text = chat.nickname
              document.querySelector('optgroup[label="Groupchats"]').appendChild(option);
            } else if (chat.type === 1 && chat.members.includes(userData.username)) {
              option.value = chat._id;
              option.text = chat.members.filter(member => member !== userData.username).join(', ');
              document.querySelector('optgroup[label="DMS"]').appendChild(option);
            }
        }}

      </script>   

      <label id="theme" style="margin-left: auto;">Theme: </label>
      <select id="theme-select" style="margin-left: auto;">
        <option value="light">Light</option>
        <option value="dark">Dark</option>
      </select>
    </div>
  </div>

  <div style="display: flex; justify-content: center;">
    <div style="width: 1280px;">
      <div style="display: flex;">
        <div style="width: 80%; margin-right: 10px;">
          <div style="max-height: 440px; overflow-y: auto;">
            <table id="post-table" bgcolor="#DDDDDD" border="1" cellpadding="2" cellspacing="2" width="100%">
            </table>
          </div>
        </div>
        <div style="width: 30%;">
          <div style="max-height: 440px; overflow-y: auto;">
            <table id="online-userlist" bgcolor="#DDDDDD" border="1" cellpadding="2" cellspacing="2" width="100%">
            </table>
          </div>

        </div>
      </div>
      <div style="margin-top: 10px;">
        <textarea id="post-textbox" style="width: 100%; height: 48px; resize: none;"></textarea>
        <div style="display: flex; justify-content: flex-end;">
          <button id="post-button" style="margin-left: 10px;">Post</button> 
        </div>
        
        <script type="module" src="sendpost.js"></script> 
        
        <script type="module">
          import { sendPost } from './sendpost.js'; 
        
          document.getElementById('post-button').addEventListener('click', sendPost);
        </script>
        
      </div>
    </div>
  </div>

  <script language="Javascript" type="module" src="displayposts.js"></script>
  <script language="Javascript" type="module" src="onlineusers.js"></script>
</body>

</html>